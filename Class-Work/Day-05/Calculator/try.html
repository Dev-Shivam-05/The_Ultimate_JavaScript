<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Calculator</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: Arial, sans-serif;
      }

      body {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-color: #f5f5f5;
      }

      .calculator {
        width: 320px;
        background-color: #333;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .display {
        width: 100%;
        height: 80px;
        background-color: #444;
        color: white;
        font-size: 32px;
        text-align: right;
        padding: 10px 20px;
        border-radius: 5px;
        margin-bottom: 20px;
        overflow: hidden;
      }

      .buttons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
      }

      button {
        height: 60px;
        border: none;
        border-radius: 5px;
        font-size: 20px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      button:hover {
        opacity: 0.9;
      }

      button:active {
        transform: scale(0.98);
      }

      .number {
        background-color: #666;
        color: white;
      }

      .operator {
        background-color: #ff9500;
        color: white;
      }

      .equals {
        background-color: #ff9500;
        color: white;
      }

      .clear,
      .delete {
        background-color: #a5a5a5;
        color: black;
      }

      .zero {
        grid-column: span 2;
      }
    </style>
  </head>
  <body>
    <div class="calculator">
      <div class="display">0</div>
      <div class="buttons">
        <button class="clear">C</button>
        <button class="delete">DEL</button>
        <button class="operator">%</button>
        <button class="operator">÷</button>

        <button class="number">7</button>
        <button class="number">8</button>
        <button class="number">9</button>
        <button class="operator">×</button>

        <button class="number">4</button>
        <button class="number">5</button>
        <button class="number">6</button>
        <button class="operator">-</button>

        <button class="number">1</button>
        <button class="number">2</button>
        <button class="number">3</button>
        <button class="operator">+</button>

        <button class="number zero">0</button>
        <button class="number">.</button>
        <button class="equals">=</button>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Get elements
        const display = document.querySelector(".display");
        const buttons = document.querySelectorAll("button");

        // Calculator state
        let currentInput = "0";
        let previousInput = "";
        let operation = null;
        let resetScreen = false;

        // Add event listeners to all buttons
        buttons.forEach((button) => {
          button.addEventListener("click", () => {
            handleButtonClick(button);
          });
        });

        function handleButtonClick(button) {
          const value = button.textContent;

          if (button.classList.contains("number")) {
            inputNumber(value);
          } else if (button.classList.contains("operator")) {
            inputOperator(value);
          } else if (button.classList.contains("equals")) {
            calculate();
          } else if (button.classList.contains("clear")) {
            clear();
          } else if (button.classList.contains("delete")) {
            deleteLastChar();
          }

          updateDisplay();
        }

        function inputNumber(number) {
          if (currentInput === "0" || resetScreen) {
            currentInput = number;
            resetScreen = false;
          } else {
            // Prevent multiple decimal points
            if (number === "." && currentInput.includes(".")) {
              return;
            }
            currentInput += number;
          }
        }

        function inputOperator(op) {
          if (operation !== null) {
            calculate();
          }

          previousInput = currentInput;
          operation = op;
          resetScreen = true;
        }

        function calculate() {
          if (operation === null || resetScreen) return;

          let result;
          const prev = parseFloat(previousInput);
          const current = parseFloat(currentInput);

          if (isNaN(prev) || isNaN(current)) return;

          switch (operation) {
            case "+":
              result = prev + current;
              break;
            case "-":
              result = prev - current;
              break;
            case "×":
              result = prev * current;
              break;
            case "÷":
              if (current === 0) {
                result = "Error";
              } else {
                result = prev / current;
              }
              break;
            case "%":
              result = prev % current;
              break;
            default:
              return;
          }

          // Check for invalid results
          if (!isFinite(result)) {
            result = "Error";
          }

          currentInput = result.toString();
          operation = null;
          previousInput = "";
          resetScreen = true;
        }

        function clear() {
          currentInput = "0";
          previousInput = "";
          operation = null;
          resetScreen = false;
        }

        function deleteLastChar() {
          if (
            currentInput.length === 1 ||
            (currentInput.length === 2 && currentInput.startsWith("-"))
          ) {
            currentInput = "0";
          } else {
            currentInput = currentInput.slice(0, -1);
          }
        }

        function updateDisplay() {
          // Format large numbers and decimals for better display
          let displayValue = currentInput;

          // Handle error state
          if (displayValue === "Error") {
            display.textContent = "Error";
            return;
          }

          // Convert to number and back to string to handle formatting
          const num = parseFloat(displayValue);
          if (!isNaN(num)) {
            // For whole numbers, just show as is
            if (Number.isInteger(num)) {
              displayValue = num.toString();
            } else {
              // For decimals, limit to reasonable precision
              displayValue = num.toString().slice(0, 12);
            }
          }

          display.textContent = displayValue;
        }
      });
    </script>
  </body>
</html>
